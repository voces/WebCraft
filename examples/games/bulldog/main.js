
import chat from "../../ui/chat.js";
import * as WebCraft from "../../../src/webcraft.js";

// delayed import
const di = path => () => import( path );

///////////////////////////////////////////////
/// Initialization
//////////////////////////////////////////////

const app = new WebCraft.App( {

	network: { host: "notextures.io", port: 8086 },

	camera: {
		x: - 11,
		z: 15,
		angleOfAttack: 32 * Math.PI / 180
	},

	terrain: {
		pointer: true,
		tileTypes: [
			{ name: "Grass", color: "#608038" },
			{ name: "Dirt", color: "#c07040" },
			{ name: "Sand", color: "#C2B280" },
			{ name: "Dry Grass", color: "#80b05f" },
			{ name: "Rock", color: "#bbbbdd" }
		],
		tilemap: [
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000"
		],
		cliffmap: [
			"22222222222222222222222222",
			"20001110000001111000000002",
			"200rrrr000000rrrrr00000002",
			"20000000000000000000000002",
			"20000000000000000000000002",
			"20000000000000000000000002",
			"20000000000000000000000002",
			"20000000000000000000000002",
			"20000000000000000000000002",
			"2000000r00r000000000000002",
			"20000011111100000000000002",
			"20000r111111r0000000000002",
			"20000r11111100000000000002",
			"22000011111100000000000002",
			"22222222222222222222222222"
		].map( row => row.split( "" ).map( v => isNaN( v ) ? v : v === " " ? "a" : parseInt( v ) ) )
	},

	types: {
		units: [
			{ name: "Farm", model: { mesh: di( "../../models/FarmModel.js" ) } },
			{ name: "Sheep", model: { mesh: di( "../../models/SheepModel.js" ) }, speed: 3.5 }
		]
	}

} );

new app.Farm( { x: - 2.5, y: - 4 } );
const sheep = new app.Sheep( { x: - 1.5 } );
setTimeout( () => sheep.traverseTo( { x: 0.5 } ), 1000 );

if ( WebCraft.isBrowser ) chat( app );

/////////////////////////////////////////////////
///// Game Logic
/////////////////////////////////////////////////

/////////////////////////////////////////////////
///// Server Events
/////////////////////////////////////////////////

/////////////////////////////////////////////////
///// Player Actions
/////////////////////////////////////////////////

/////////////////////////////////////////////////
///// Levels
/////////////////////////////////////////////////

/////////////////////////////////////////////////
///// Misc
/////////////////////////////////////////////////

export default app;

if ( typeof window === "object" ) window.app = app;

