
import chat from "../../ui/chat.js";
import * as WebCraft from "../../../src/webcraft.js";

// delayed import
const di = path => () => import( path );

///////////////////////////////////////////////
/// Initialization
//////////////////////////////////////////////

const SIZE = 0.5;

const app = new WebCraft.App( {

	network: { host: "notextures.io", port: 8086 },

	camera: {
		x: - 25,
		z: 5,
		angleOfAttack: 75 * Math.PI / 180
	},

	terrain: {
		tileTypes: [
			{ name: "Grass", color: "#608038" },
			{ name: "Dirt", color: "#c07040" },
			{ name: "Sand", color: "#C2B280" },
			{ name: "Dry Grass", color: "#80b05f" },
			{ name: "Rock", color: "#bbbbdd" }
		],
		tilemap: [
			// "00000000000000000000000000",
			// "00000000000000000000000000",
			// "00003330000000000000000000",
			// "00000330000000000000000000",
			// "00000000000000000000000000",
			// "00000000000000000000000000",
			// "00000000000000000000000000",
			// "00000000000000000000000000",
			// "00000001001000000000000000",
			// "00000001001000000000000000",
			// "00000001001000000000000000",
			// "00022220000111000000000000",
			// "00022220000000000000000000",
			// "00000000000000000000000000",
			// "00000000000000000000000000"
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000",
			"00000000000000000000000000"
		],
		heightmap: [
			// "01r0",
			// "01r0"
			// "00",
			// "11",
			// "rr",
			// "00"
			"00000000",
			"0r104r50",
			"00r0r0r0",
			" 02r3060",
			" 00000r0",
			" 09r8r70",
			" 0000000"
			// "22222222222222222222222222",
			// "20001110000001111000000002",
			// "200rrrr000000rrrrr00000002",
			// "20000000000000000000000002",
			// "20000000000000000000000002",
			// "20000000000000000000000002",
			// "20000000000000000000000002",
			// "20000000000000000000000002",
			// "20000000000000000000000002",
			// "2000000r00r000000000000002",
			// "20000011111100000000000002",
			// "20000r111111r0000000000002",
			// "20000r11111100000000000002",
			// "22000011111100000000000002",
			// "22222222222222222222222222"
		].map( row => row.split( "" ).map( v => isNaN( v ) ? v : v === " " ? "a" : parseInt( v ) ) )
	},

	types: {
		doodads: [
			{ name: "Green", model: { mesh: di( "../../models/CubeModel.js" ), color: "#B5FEB4" } },
			{ name: "TileWhite", model: { mesh: di( "../../models/CubeModel.js" ), color: "#F7F7FF" } },
			{ name: "TileGray", model: { mesh: di( "../../models/CubeModel.js" ), color: "#E6E6FF" } }
		],
		units: [
			{ name: "Character", model: { mesh: di( "../../models/CubeModel.js" ), scale: SIZE }, speed: 3.5 },
			{ name: "Food", model: { mesh: di( "../../models/SphereModel.js" ), color: "#FFFF00", scale: 0.5 }, state: [ "food" ] },
			{ name: "Enemy", model: { mesh: di( "../../models/SphereModel.js" ), color: "#0000FF", scale: 0.5 }, speed: 7 }
		]
	}
} );

app.state = { players: app.players, units: app.units, doodads: app.doodads, levelIndex: 0 };

if ( WebCraft.isBrowser ) chat( app );

/////////////////////////////////////////////////
///// Game Logic
/////////////////////////////////////////////////

/////////////////////////////////////////////////
///// Server Events
/////////////////////////////////////////////////

/////////////////////////////////////////////////
///// Player Actions
/////////////////////////////////////////////////

/////////////////////////////////////////////////
///// Levels
/////////////////////////////////////////////////

/////////////////////////////////////////////////
///// Misc
/////////////////////////////////////////////////

export default app;

if ( typeof window === "object" ) window.app = app;

